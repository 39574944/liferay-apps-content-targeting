<?xml version="1.0"?>
<!DOCTYPE project>

<project>
	<import file="../../build-common-plugins.xml" />

	<target name="build-app">
		<antcall target="clean" />

		<build-app-module-service module.dir="analytics-api" />
		<build-app-module-service module.dir="anonymous-users-api" />
		<build-app-module-service module.dir="geolocation-api" />
		<build-app-module-service module.dir="content-targeting-api" />
		<build-app-module-service module.dir="report-campaign-content" />
		<build-app-module-service module.dir="report-user-segment-content" />
		<build-app-module-service module.dir="rule-score-points" />

		<antcall target="deploy" />
	</target>

	<macrodef name="build-app-module-service">
		<attribute name="module.dir" />

		<sequential>
			<process-ivy module.dir="@{module.dir}" />

			<compile-import-shared module.dir="@{module.dir}" />

			<ant dir="@{module.dir}" target="build-service" inheritAll="false" />
		</sequential>
	</macrodef>

	<target name="test-app">
		<antcall target="test" />

		<ant dir="analytics-test" target="test" inheritAll="false" />
		<ant dir="anonymous-users-test" target="test" inheritAll="false" />
		<ant dir="content-targeting-test" target="test" inheritAll="false" />
	</target>
</project>